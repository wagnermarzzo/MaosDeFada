<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Michelly Vanessa Unhas</title>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:url("https://images.unsplash.com/photo-1604654894610-df63bc536371") no-repeat center center fixed;
    background-size:cover;
}

.container{
    background:rgba(255,255,255,0.95);
    max-width:500px;
    margin:40px auto;
    padding:25px;
    border-radius:15px;
}

h1{
    text-align:center;
    color:#d63384;
}

label{
    font-weight:bold;
}

input, select{
    width:100%;
    padding:10px;
    margin:8px 0 15px 0;
    border-radius:8px;
    border:1px solid #ccc;
}

button{
    width:100%;
    padding:12px;
    background:#d63384;
    color:white;
    border:none;
    border-radius:10px;
    font-size:16px;
    cursor:pointer;
}

button:disabled{
    background:gray;
}
</style>
</head>

<body>

<div class="container">
<h1>üíÖ Michelly Vanessa Unhas</h1>

<form id="formAgendamento">

<label>Nome</label>
<input type="text" id="nome" required>

<label>Data</label>
<input type="date" id="data" required>

<label>Hor√°rio</label>
<select id="horario" required>
<option value="">Selecione</option>
</select>

<label>Servi√ßo</label>
<select id="servico" required>
<option>M√£o e P√©</option>
<option>Unha em Gel</option>
<option>Unha em Fibra</option>
</select>

<button type="submit" id="btnAgendar">Agendar</button>

</form>
</div>

<script>

const horarios = {
    "sexta":["18:00","20:00"],
    "sabado":["07:00","09:00","11:00","14:00","17:00","19:00"]
};

const selectHorario = document.getElementById("horario");
const inputData = document.getElementById("data");

function formatarDataBR(dataISO){
    const partes = dataISO.split("-");
    return `${partes[2]}/${partes[1]}/${partes[0]}`;
}

function atualizarHorarios(){
    selectHorario.innerHTML = '<option value="">Selecione</option>';

    const dataSelecionada = new Date(inputData.value + "T00:00:00");
    const diaSemana = dataSelecionada.getDay();

    let lista = [];

    if(diaSemana === 5) lista = horarios.sexta;
    if(diaSemana === 6) lista = horarios.sabado;

    const agendamentos = JSON.parse(localStorage.getItem("agendamentos")) || [];

    lista.forEach(h=>{
        const ocupado = agendamentos.some(a => a.data === inputData.value && a.horario === h);

        if(!ocupado){
            const option = document.createElement("option");
            option.value = h;
            option.textContent = h;
            selectHorario.appendChild(option);
        }
    });
}

inputData.addEventListener("change", atualizarHorarios);

document.getElementById("formAgendamento").addEventListener("submit", function(e){
    e.preventDefault();

    const btn = document.getElementById("btnAgendar");
    btn.disabled = true;
    btn.innerText = "Agendando...";

    const nome = document.getElementById("nome").value;
    const data = document.getElementById("data").value;
    const horario = document.getElementById("horario").value;
    const servico = document.getElementById("servico").value;

    const agendamentos = JSON.parse(localStorage.getItem("agendamentos")) || [];

    // üîí BLOQUEIO DUPLICIDADE
    const existe = agendamentos.some(a => a.data === data && a.horario === horario);

    if(existe){
        alert("Esse hor√°rio j√° foi agendado!");
        btn.disabled = false;
        btn.innerText = "Agendar";
        return;
    }

    agendamentos.push({nome, data, horario, servico});
    localStorage.setItem("agendamentos", JSON.stringify(agendamentos));

    atualizarHorarios();

    const mensagem = `Ol√° üíÖ Novo agendamento!

Nome: ${nome}
Data: ${formatarDataBR(data)}
Hor√°rio: ${horario}
Servi√ßo: ${servico}`;

    const numero = "5511964657571";
    const url = `https://wa.me/${numero}?text=${encodeURIComponent(mensagem)}`;

    window.location.href = url;
});

</script>

</body>
</html>
